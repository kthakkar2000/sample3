<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Kalindi ‚Äî Samsung washing machine 12kg</title>
<style>
:root{
  --bg:#0f1723; --card:#0b1220; --muted:#9aa4b2;
  --accent1:#7c3aed; --accent2:#06b6d4;
  font-family:Inter,system-ui,-apple-system,Roboto,'Segoe UI',Arial;
}
html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#081018);color:#e6eef6}
.container{max-width:460px;margin:18px auto;padding:16px}
header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;position:relative;z-index:30}
.left{display:flex;gap:12px;align-items:center}
.logo-img{width:84px;height:84px;border-radius:12px;overflow:hidden;box-shadow:0 10px 30px rgba(2,6,23,0.6);background:#fff;flex-shrink:0}
.logo-img img{width:100%;height:100%;object-fit:contain}
.title-wrap{line-height:1}
.shop{font-size:18px;font-weight:800}
.sub{font-size:12px;color:var(--muted)}
.lang-switch{display:flex;gap:8px}
.lang-btn{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--muted);font-weight:700;cursor:pointer;outline:none}
.lang-btn.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;box-shadow:0 10px 28px rgba(124,58,237,0.12)}
.lang-btn:focus{box-shadow:0 0 0 3px rgba(7,125,255,0.12)}

.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:18px;padding:12px;box-shadow:0 14px 40px rgba(2,6,23,0.6)}
.gallery{position:relative;overflow:hidden;border-radius:14px}
.slides{display:flex;transition:transform .36s cubic-bezier(.2,.9,.2,1)}
.slides img{width:100%;height:320px;object-fit:cover;flex-shrink:0;background:#071018}
.dots{display:flex;gap:6px;position:absolute;left:12px;bottom:10px;z-index:15}
.dot{width:9px;height:9px;border-radius:6px;background:rgba(255,255,255,0.06)}
.dot.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:0 6px 18px rgba(6,182,212,0.08)}

.product-name{font-weight:900;font-size:18px;margin-top:12px;text-align:center}
.small-muted{color:var(--muted);font-size:13px;margin-top:6px;text-align:center}

.bot{display:flex;gap:12px;align-items:center;margin-top:14px;padding:12px;border-radius:12px;background:linear-gradient(90deg, rgba(124,58,237,0.05), rgba(6,182,212,0.03));position:relative;z-index:20}
.mic{width:58px;height:58px;border-radius:12px;background:linear-gradient(180deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#fff;font-size:22px;cursor:pointer;flex-shrink:0;border:0}
.mic.listening{box-shadow:0 16px 48px rgba(124,58,237,0.18);transform:scale(1.04)}
.bot-info{flex:1}
.bot-title{font-weight:800}
.bot-sub{font-size:13px;color:var(--muted);margin-top:6px}
.transcript{margin-top:8px;font-size:14px;color:var(--muted);min-height:46px}

/* CHAT UI */
.chat{margin-top:16px;background:rgba(255,255,255,0.02);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:12px}
.chat-messages{max-height:260px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;padding-right:6px}
.msg{padding:10px;border-radius:10px;max-width:85%;font-size:14px;line-height:1.4}
.msg.user{align-self:flex-end;background:linear-gradient(90deg,var(--accent2),#10b981);color:#042022}
.msg.bot{align-self:flex-start;background:rgba(255,255,255,0.06);color:#e6eef6}
.chat-input{display:flex;gap:8px}
.chat-input input{flex:1;padding:10px;border-radius:8px;border:0;font-size:14px;background:rgba(255,255,255,0.02);color:inherit}
.chat-input button{padding:10px 12px;border:0;border-radius:8px;cursor:pointer;font-size:14px}
#chatSend{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white}
#chatMic{background:#222;color:#eee}

/* small responsive tweak */
@media (max-width:420px){ .slides img{height:260px} .logo-img{width:64px;height:64px} .shop{font-size:15px} }
</style>
</head>
<body>
  <div class="container">
    <header>
      <div class="left">
        <div class="logo-img"><img id="logoImg" src="assets/ktpl-new-logo.png" alt="Kalindi logo"/></div>
        <div class="title-wrap">
          <div class="shop">Kalindi Tradelinks Pvt Ltd</div>
          <div class="sub">Home Appliances ‚Ä¢ Washing Machine</div>
        </div>
      </div>

      <div class="lang-switch" role="tablist" aria-label="Language">
        <button class="lang-btn active" id="btn-en" aria-selected="true">English</button>
        <button class="lang-btn" id="btn-gu" aria-selected="false">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</button>
      </div>
    </header>

    <main class="card">
      <div class="gallery" id="gallery">
        <div class="slides" id="slides">
          <img src="assets/wm1.jpg" alt="product image 1" />
          <img src="assets/wm2.jpg" alt="product image 2" />
          <img src="assets/wm3.jpg" alt="product image 3" />
          <img src="assets/wm4.jpg" alt="product image 4" />
          <img src="assets/wm5.jpg" alt="product image 5" />
        </div>
        <div class="dots" id="dots" aria-hidden="true"></div>
      </div>

      <div class="product-name">Samsung washing machine 12kg</div>
      <div class="small-muted">Tap the mic and ask. Responses available in English and Gujarati.</div>

      <div class="bot" role="region" aria-label="Product voice assistant">
        <button class="mic" id="mic" title="Tap to speak" aria-pressed="false">üéôÔ∏è</button>
        <div class="bot-info">
          <div class="bot-title" id="assistant-title">Product Voice Assistant</div>
          <div class="bot-sub" id="assistant-sub">Select language, tap mic and ask about price, warranty, usage and more.</div>
          <div class="transcript" id="transcript">Assistant ready. Select language and tap mic to ask.</div>
        </div>
      </div>

      <!-- Chat area (typing + chat mic) -->
      <div class="chat" id="chat">
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
          <input id="chatInput" type="text" placeholder="Type your question..." aria-label="Type question">
          <button id="chatSend" title="Send">Send</button>
          <button id="chatMic" title="Tap to speak from chat">üéôÔ∏è</button>
        </div>
      </div>

    </main>

    <footer>¬© Kalindi Tradelinks Pvt Ltd</footer>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

  /* ---------------- PRODUCT DATA (edit here if you want) ---------------- */
  // Single product inline config (template for QR / multiple products approach can load JSON instead)
  const PRODUCT = {
    id: 'samsung-12kg',
    title: 'Samsung washing machine 12kg',
    images: ['assets/wm1.jpg','assets/wm2.jpg','assets/wm3.jpg','assets/wm4.jpg','assets/wm5.jpg'],
    price: '‚Çπ65,000',
    specs: {
      capacity: '12 kg',
      energy: '5 Star',
      rpm: '1200',
      warranty: '2 years',
      dimensions: 'H 85 cm √ó W 60 cm √ó D 55‚Äì70 cm',
      inverter: 'Digital Inverter Motor',
      dryer: 'Some variants have dryer function',
      water_per_cycle: '50‚Äì70 L',
      power_per_cycle: '1.2‚Äì1.5 kWh'
    },
    description_en: 'Samsung 12 kg front-load washers combine AI wash optimisation, Digital Inverter motor, Quick/Eco programs, and SmartThings on select models.',
    description_gu: 'Samsung 12 kg ‡™´‡´ç‡™∞‡™®‡´ç‡™ü-‡™≤‡´ã‡™° ‡™µ‡´ã‡™∂‡™∞‡´ç‡™∏‡™Æ‡™æ‡™Ç AI ‡™µ‡´ã‡™∂, ‡™°‡™ø‡™ú‡™ø‡™ü‡™≤ ‡™á‡™®‡™µ‡™∞‡´ç‡™ü‡™∞ ‡™Æ‡´ã‡™ü‡™∞, ‡™ï‡´ç‡™µ‡™ø‡™ï/‡™è‡™ï‡´ã ‡™™‡´ç‡™∞‡´ã‡™ó‡´ç‡™∞‡™æ‡™Æ ‡™Ö‡™®‡´á ‡™ï‡´á‡™ü‡™≤‡™æ‡™Ç‡™ï ‡™Æ‡´ã‡™°‡´á‡™≤‡™Æ‡™æ‡™Ç SmartThings ‡™∏‡™™‡´ã‡™∞‡´ç‡™ü ‡™π‡´ã‡™Ø ‡™õ‡´á.',
    // product-specific prompts (regex-like string 'q' will be used with RegExp)
    prompts: [
      { q: 'price|cost|‚Çπ|rupee', en: 'The price of this model is ‚Çπ65,000. Offers and final price may vary in-store.', gu: '‡™Ü ‡™Æ‡´ã‡™°‡´á‡™≤‡™®‡´Ä ‡™ï‡™ø‡™Ç‡™Æ‡™§ ‡™∞‡´Ç. 65,000 ‡™õ‡´á. ‡™∏‡´ç‡™ü‡´ã‡™∞‡™Æ‡™æ‡™Ç ‡™ì‡™´‡™∞‡´ç‡™∏ ‡™Ö‡™®‡´Å‡™∏‡™æ‡™∞ ‡™Ö‡™Ç‡™§‡™ø‡™Æ ‡™ï‡™ø‡™Ç‡™Æ‡™§ ‡™¨‡™¶‡™≤‡´Ä ‡™∂‡™ï‡´á ‡™õ‡´á.' },
      { q: 'stock|available', en: 'Stock varies by store. Please call or visit our shop to confirm availability.', gu: '‡™∏‡´ç‡™ü‡´ã‡™ï ‡™∏‡´ç‡™ü‡´ã‡™∞‡™∏ ‡™™‡™∞ ‡™Ü‡™ß‡™æ‡™∞ ‡™∞‡™æ‡™ñ‡´á ‡™õ‡´á. ‡™ï‡´É‡™™‡™æ ‡™ï‡™∞‡´Ä‡™®‡´á ‡™∏‡´ç‡™ü‡´ã‡™∞‡™Æ‡™æ‡™Ç ‡™§‡™™‡™æ‡™∏‡´ã.' },
      { q: 'describe|description|details|model description|all description', en: PRODUCT?.description_en || '', gu: PRODUCT?.description_gu || '' },
      { q: 'usage|how to use|how do i use|what is the use', en: 'Load clothes evenly, use recommended detergent, select appropriate program and avoid overloading.', gu: '‡™ï‡™™‡™°‡™æ‡™Ç ‡™∏‡™Æ‡™æ‡™® ‡™∞‡´Ä‡™§‡´á ‡™≤‡´ã‡™° ‡™ï‡™∞‡´ã, ‡™∏‡´Ç‡™ö‡™ø‡™§ ‡™°‡™ø‡™∏‡™∞‡´ç‡™ü ‡™ú‡™æ‡™®‡´ã ‡™â‡™™‡™Ø‡´ã‡™ó ‡™ï‡™∞‡´ã ‡™Ö‡™®‡´á ‡™ì‡™µ‡™∞‡™≤‡´ã‡™° ‡™ü‡™æ‡™≥‡´ã.' },
      { q: 'water|litre|consumption', en: 'Approx 50‚Äì70 litres per full wash depending on program.', gu: '‡™™‡´ç‡™∞‡´ã‡™ó‡´ç‡™∞‡™æ‡™Æ ‡™™‡™∞ ‡™Ü‡™ß‡™æ‡™∞ ‡™∞‡™æ‡™ñ‡´Ä‡™®‡´á ‡™≤‡™ó‡™≠‡™ó 50‚Äì70 ‡™≤‡™ø‡™ü‡™∞ ‡™™‡™æ‡™£‡´Ä ‡™µ‡™™‡™∞‡™æ‡™Ø ‡™õ‡´á.' },
      { q: 'colour|color|available color|which color', en: 'Common colours: Pearl White, Graphite Silver ‚Äî availability depends on stock.', gu: '‡™™‡´ç‡™∞‡™æ‡™™‡´ç‡™§ ‡™∞‡™Ç‡™ó‡´ã: ‡™™‡™∞‡´ç‡™≤ ‡™µ‡´ç‡™π‡™æ‡™á‡™ü, ‡™ó‡´ç‡™∞‡™æ‡™´‡™æ‡™á‡™ü ‡™∏‡™ø‡™≤‡´ç‡™µ‡™∞ ‚Äî ‡™∏‡´ç‡™ü‡´ã‡™ï ‡™™‡™∞ ‡™Ü‡™ß‡™æ‡™∞.' },
      { q: 'dimension|size|height|width|depth', en: 'Approx dimensions: H 85 cm √ó W 60 cm √ó D 55‚Äì70 cm (model dependent).', gu: '‡™Ö‡™Ç‡™¶‡™æ‡™ú‡´Ä‡™§ ‡™Æ‡™æ‡™™: ‡™ä‡™Ç‡™ö‡™æ‡™à 85 cm √ó ‡™™‡™π‡´ã‡™≥‡™æ‡™à 60 cm √ó ‡™ä‡™Ç‡™°‡™æ‡™à 55‚Äì70 cm (‡™Æ‡´ã‡™°‡´á‡™≤ ‡™Æ‡´Å‡™ú‡™¨).' },
      { q: 'electric|power|watt|energy|consumption', en: 'Typical energy per full wash is around 1.2‚Äì1.5 kWh; Eco/AI modes reduce consumption.', gu: '‡™™‡´Ç‡™∞‡™®‡™æ ‡™µ‡´ã‡™∂ ‡™Æ‡™æ‡™ü‡´á ‡™∏‡™æ‡™Æ‡™æ‡™®‡´ç‡™Ø ‡™∞‡´Ä‡™§‡´á ~1.2‚Äì1.5 kWh ‡™ä‡™∞‡´ç‡™ú‡™æ ‡™ñ‡™∞‡´ç‡™ö ‡™•‡™æ‡™Ø ‡™õ‡´á; ‡™è‡™ï‡´ã ‡™Æ‡´ã‡™° energie ‡™¨‡™ö‡™æ‡™µ‡´á ‡™õ‡´á.' },
      { q: 'dryer|dry function|dryer function', en: 'Some Samsung variants are washer-dryer combos ‚Äî check the specific model for dryer capability.', gu: '‡™ï‡´á‡™ü‡™≤‡™æ‡™Ç‡™ï ‡™Æ‡´ã‡™°‡´á‡™≤‡´ã ‡™µ‡´ã‡™∂‡™∞-‡™°‡´ç‡™∞‡™æ‡™Ø‡™∞ ‡™ï‡´â‡™Æ‡´ç‡™¨‡´ã ‡™õ‡´á ‚Äî ‡™ö‡´ã‡™ï‡´ç‡™ï‡™∏ ‡™Æ‡´ã‡™°‡´á‡™≤ ‡™§‡™™‡™æ‡™∏‡´ã.' },
      { q: 'inverter|digital inverter|motor', en: 'Yes ‚Äî modern Samsung front-load machines use a Digital Inverter Motor for efficiency and durability.', gu: '‡™π‡™æ‡™Ç ‚Äî ‡™Ü‡™ß‡´Å‡™®‡™ø‡™ï ‡™Æ‡™∂‡´Ä‡™®‡´ã‡™Æ‡™æ‡™Ç ‡™°‡™ø‡™ú‡™ø‡™ü‡™≤ ‡™á‡™®‡™µ‡™∞‡´ç‡™ü‡™∞ ‡™Æ‡´ã‡™ü‡™∞ ‡™π‡´ã‡™Ø ‡™õ‡´á ‡™ú‡´á ‡™µ‡™ß‡´Å ‡™ï‡™æ‡™∞‡´ç‡™Ø‡™ï‡´ç‡™∑‡™Æ ‡™Ö‡™®‡´á ‡™ü‡™ï‡™æ‡™â ‡™π‡´ã‡™Ø ‡™õ‡´á.' },
      { q: 'family|how many family|suitable for', en: '12 kg is suitable for medium to large families (4+ members) and handles bedding and blankets comfortably.', gu: '12 kg ‡™Æ‡™ß‡´ç‡™Ø‡™Æ ‡™•‡´Ä ‡™Æ‡´ã‡™ü‡™æ ‡™™‡™∞‡™ø‡™µ‡™æ‡™∞ (4+ ‡™∏‡™≠‡´ç‡™Ø‡´ã) ‡™Æ‡™æ‡™ü‡´á ‡™Ø‡´ã‡™ó‡´ç‡™Ø ‡™õ‡´á ‡™Ö‡™®‡´á ‡™¨‡´á‡™°‡™ø‡™Ç‡™ó/‡™¨‡´ç‡™≤‡´á‡™®‡´ç‡™ï‡´á‡™ü ‡™∏‡™∞‡™≥‡™§‡™æ‡™•‡´Ä ‡™ß‡´ã‡™à ‡™∂‡™ï‡´á ‡™õ‡´á.' },
      { q: 'display|digital|wifi|smartthings|smart', en: 'Selected models include a digital display and Wi-Fi / SmartThings support for remote control; check model spec.', gu: '‡™ï‡´á‡™ü‡™≤‡™æ‡™Ç‡™ï ‡™Æ‡´ã‡™°‡´á‡™≤‡´ã ‡™°‡™ø‡™∏‡´ç‡™™‡´ç‡™≤‡´á ‡™Ö‡™®‡´á Wi-Fi / SmartThings ‡™∏‡™™‡´ã‡™∞‡´ç‡™ü ‡™∏‡™æ‡™•‡´á ‡™Ü‡™µ‡´á ‡™õ‡´á; ‡™ö‡´ã‡™ï‡´ç‡™ï‡™∏ ‡™Æ‡´ã‡™°‡´á‡™≤ ‡™§‡™™‡™æ‡™∏‡´ã.' },
      { q: 'advantages|benefit|why should i buy|why buy', en: 'Advantages: large capacity, efficient digital inverter motor, advanced wash programs (Quick/Eco/Steam), and optional smart features for convenience.', gu: '‡™≤‡™æ‡™≠: ‡™Æ‡´ã‡™ü‡´Ä ‡™ï‡´ç‡™∑‡™Æ‡™§‡™æ, ‡™ï‡™æ‡™∞‡´ç‡™Ø‡™ï‡´ç‡™∑‡™Æ ‡™á‡™®‡™µ‡™∞‡´ç‡™ü‡™∞ ‡™Æ‡´ã‡™ü‡™∞, ‡™Ö‡™¶‡´ç‡™Ø‡™§‡™® ‡™™‡´ç‡™∞‡´ã‡™ó‡´ç‡™∞‡™æ‡™Æ ‡™Ö‡™®‡´á ‡™ï‡´á‡™ü‡™≤‡™æ‡™ï ‡™Æ‡´ã‡™°‡´á‡™≤‡´ã‡™Æ‡™æ‡™Ç ‡™∏‡´ç‡™Æ‡™æ‡™∞‡´ç‡™ü ‡™∏‡´Å‡™µ‡™ø‡™ß‡™æ‡™ì.' },
      { q: 'smaller|instead of a smaller capacity|why not smaller', en: 'A 12kg handles bulky items and heavy loads in fewer cycles ‚Äî saving time and energy versus smaller machines.', gu: '12 kg ‡™Æ‡´ã‡™ü‡™æ/‡™≠‡™æ‡™∞‡´á ‡™≤‡´ã‡™°‡™®‡´á ‡™ì‡™õ‡™æ ‡™∏‡™æ‡™Ø‡™ï‡™≤‡™Æ‡™æ‡™Ç ‡™ß‡´ã‡™à ‡™∂‡™ï‡´á ‡™õ‡´á ‚Äî ‡™∏‡™Æ‡™Ø ‡™Ö‡™®‡´á ‡™ä‡™∞‡´ç‡™ú‡™æ ‡™¨‡™ö‡™æ‡™µ‡´á ‡™õ‡´á.' },
      { q: 'programs|quick wash|eco wash|special programs', en: 'Yes ‚Äî many models include Quick Wash, Eco mode, Hygiene/Steam cycles and program presets for delicates and bedding.', gu: '‡™π‡™æ‡™Ç ‚Äî ‡™ï‡´ç‡™µ‡™ø‡™ï ‡™µ‡´ã‡™∂, ‡™è‡™ï‡´ã ‡™Æ‡´ã‡™° ‡™Ö‡™®‡´á ‡™∏‡´ç‡™ü‡´Ä‡™Æ/‡™π‡™æ‡™à‡™ú‡´Ä‡™® ‡™™‡´ç‡™∞‡´ã‡™ó‡´ç‡™∞‡™æ‡™Æ ‡™ò‡™£‡™æ ‡™Æ‡´ã‡™°‡´á‡™≤‡´ã ‡™ß‡™∞‡™æ‡™µ‡´á ‡™õ‡´á.' },
      { q: 'heavy loads|blankets|curtains', en: 'Yes ‚Äî this 12 kg machine is designed to handle blankets, curtains and other bulky items comfortably.', gu: '‡™π‡™æ ‚Äî 12 kg ‡™Æ‡™∂‡´Ä‡™® ‡™≠‡™æ‡™∞‡´á‡™≤‡´Å‡™Ç ‡™≤‡´ã‡™° ‡™Ö‡™®‡´á ‡™¨‡´á‡™°‡™ø‡™Ç‡™ó ‡™∏‡™∞‡™≥‡™§‡™æ‡™•‡´Ä ‡™π‡´á‡™®‡´ç‡™°‡™≤ ‡™ï‡™∞‡´á ‡™õ‡´á.' },
      { q: 'feedback|reviews|customer review|customer feedback', en: 'Sample customer feedback: 1) Great cleaning and gentle on clothes. 2) Large drum ‚Äî perfect for bedding. 3) Smart features are useful. 4) Quiet and low vibration.', gu: '‡™ó‡´ç‡™∞‡™æ‡™π‡™ï ‡™™‡´ç‡™∞‡™§‡™ø‡™∏‡™æ‡™¶: 1) ‡™∏‡™æ‡™∞‡´Ä ‡™∏‡™æ‡™´‡™∏‡™´‡™æ‡™á. 2) ‡™Æ‡´ã‡™ü‡´Ä ‡™°‡´ç‡™∞‡™Æ. 3) ‡™∏‡´ç‡™Æ‡™æ‡™∞‡´ç‡™ü ‡™´‡´Ä‡™ö‡™∞‡´ç‡™∏ ‡™â‡™™‡™Ø‡´ã‡™ó‡´Ä. 4) ‡™∂‡™æ‡™Ç‡™§ ‡™ì‡™™‡™∞‡´á‡™∂‡™®.' }
    ]
  };
  /* ---------------- end PRODUCT ---------------- */

  // fill product title (if you want dynamic)
  document.querySelector('.product-name').textContent = PRODUCT.title;

  /* ---------------- slider ---------------- */
  const slidesEl = document.getElementById('slides');
  const dotsEl = document.getElementById('dots');

  // ensure slides match PRODUCT.images (only if needed)
  (function populateSlides(){
    slidesEl.innerHTML = '';
    PRODUCT.images.forEach(src => {
      const img = document.createElement('img');
      img.src = src;
      img.alt = PRODUCT.title;
      slidesEl.appendChild(img);
    });
  })();

  let idx = 0;
  function buildDots(){
    dotsEl.innerHTML = '';
    const imgs = slidesEl.querySelectorAll('img');
    imgs.forEach((_,i) => {
      const d = document.createElement('div');
      d.className = 'dot' + (i===0 ? ' active' : '');
      d.addEventListener('click', ()=> { idx = i; updateSlide(); });
      dotsEl.appendChild(d);
    });
  }
  function updateSlide(){
    slidesEl.style.transform = `translateX(${-idx*100}%)`;
    Array.from(dotsEl.children).forEach((d,i)=> d.classList.toggle('active', i===idx));
  }
  buildDots();
  setInterval(()=> { const imgs = slidesEl.querySelectorAll('img'); if(imgs.length) { idx = (idx+1) % imgs.length; updateSlide(); } }, 4500);
  // swipe
  let startX = null;
  const gallery = document.getElementById('gallery');
  gallery.addEventListener('touchstart', e => startX = e.changedTouches[0].clientX);
  gallery.addEventListener('touchend', e => {
    if(startX === null) return;
    const endX = e.changedTouches[0].clientX; const dx = endX - startX;
    if(Math.abs(dx) > 40){
      const imgs = slidesEl.querySelectorAll('img');
      if(dx < 0) idx = Math.min(idx+1, imgs.length-1); else idx = Math.max(idx-1,0);
      updateSlide();
    }
    startX = null;
  });

  /* ---------------- language toggle ---------------- */
  let currentLang = 'en';
  const btnEn = document.getElementById('btn-en'), btnGu = document.getElementById('btn-gu');
  function setLang(lang){
    currentLang = lang;
    if(lang === 'en'){ btnEn.classList.add('active'); btnGu.classList.remove('active'); document.getElementById('assistant-sub').textContent = 'Select language, tap mic and ask about price, warranty, usage and more.'; }
    else { btnGu.classList.add('active'); btnEn.classList.remove('active'); document.getElementById('assistant-sub').textContent = '‡™≠‡™æ‡™∑‡™æ ‡™™‡™∏‡™Ç‡™¶ ‡™ï‡™∞‡´ã, ‡™Æ‡™æ‡™à‡™ï ‡™¶‡™¨‡™æ‡™µ‡´ã ‡™Ö‡™®‡´á ‡™™‡´ç‡™∞‡™∂‡´ç‡™® ‡™™‡´Ç‡™õ‡´ã.'; }
    // update recognition language when active
    if(recognition) recognition.lang = (currentLang === 'en' ? 'en-IN' : 'gu-IN');
  }
  btnEn.addEventListener('click', ()=> setLang('en'));
  btnGu.addEventListener('click', ()=> setLang('gu'));

  /* ---------------- speech synthesis and tap sound ---------------- */
  function speak(text, langTag='en-IN'){
    if(!('speechSynthesis' in window)) return;
    const u = new SpeechSynthesisUtterance(text);
    u.lang = langTag;
    u.rate = 1;
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(u);
  }
  let audioCtx = null;
  function playTap(){
    try{
      if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const now = audioCtx.currentTime;
      const o = audioCtx.createOscillator();
      const g = audioCtx.createGain();
      o.type = 'sine';
      o.frequency.setValueAtTime(1000, now);
      g.gain.setValueAtTime(0, now);
      g.gain.linearRampToValueAtTime(0.12, now + 0.001);
      g.gain.exponentialRampToValueAtTime(0.001, now + 0.12);
      o.connect(g); g.connect(audioCtx.destination);
      o.start(now); o.stop(now + 0.14);
    }catch(e){ console.warn('tap sound', e && e.message); }
  }

  /* ---------------- prompt matching ---------------- */
  function matchProductPrompt(text){
    if(!PRODUCT.prompts) return null;
    const q = text.toLowerCase();
    for(const p of PRODUCT.prompts){
      try{
        const re = new RegExp(p.q, 'i');
        if(re.test(q)) return currentLang === 'en' ? p.en : p.gu;
      }catch(e){
        if(q.indexOf(p.q.toLowerCase()) !== -1) return currentLang === 'en' ? p.en : p.gu;
      }
    }
    return null;
  }

  // global fallback prompts
  const globalPrompts = [
    { q: /price|cost|‚Çπ|rupee/i, en: PRODUCT.price || 'Price not available', gu: PRODUCT.price ? PRODUCT.price + ' (‡™∏‡´ç‡™ü‡´ã‡™∞ ‡™™‡™∞ ‡™Ü‡™ß‡™æ‡™∞‡™ø‡™§)' : '‡™Æ‡´Ç‡™≤‡´ç‡™Ø ‡™â‡™™‡™≤‡™¨‡´ç‡™ß ‡™®‡™•‡´Ä' },
    { q: /warrant(?:y|ies)|guarantee/i, en: '2 year manufacturer warranty typically; check exact model.', gu: '‡™∏‡™æ‡™Æ‡™æ‡™®‡´ç‡™Ø ‡™∞‡´Ä‡™§‡´á 2 ‡™µ‡™∞‡´ç‡™∑‡™®‡´Ä ‡™µ‡´ã‡™∞‡™Ç‡™ü‡´Ä ‡™Æ‡™≥‡´á ‡™õ‡´á; ‡™ö‡´ã‡™ï‡´ç‡™ï‡™∏ ‡™Æ‡´ã‡™°‡´á‡™≤ ‡™§‡™™‡™æ‡™∏‡´ã.' },
    { q: /service|repair|support/i, en: 'We provide doorstep service and free checkups during warranty (check store).', gu: '‡™µ‡´ã‡™∞‡™Ç‡™ü‡´Ä ‡™¶‡™∞‡™Æ‡™ø‡™Ø‡™æ‡™® ‡™°‡´ã‡™∞‡™∏‡´ç‡™ü‡´á‡™™ ‡™∏‡™∞‡´ç‡™µ‡™ø‡™∏ ‡™Ö‡™®‡´á ‡™Æ‡™´‡™§ ‡™ö‡´á‡™ï‡™Ö‡™™ ‡™Ü‡™™‡™µ‡™æ‡™Æ‡™æ‡™Ç ‡™Ü‡™µ‡´á ‡™õ‡´á.' }
  ];
  function matchGlobal(text){
    const q = text.toLowerCase();
    for(const g of globalPrompts){
      if(g.q.test(q)) return currentLang === 'en' ? g.en : g.gu;
    }
    return null;
  }

  /* ---------------- Chat helpers ---------------- */
  const chatMessages = document.getElementById('chatMessages');
  const chatInput = document.getElementById('chatInput');
  const chatSend = document.getElementById('chatSend');
  const chatMic = document.getElementById('chatMic');
  function addMessage(text, who='user'){
    const d = document.createElement('div'); d.className = 'msg ' + who; d.textContent = text;
    chatMessages.appendChild(d); chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  function respond(answerText){
    const prefix = currentLang === 'en' ? 'Assistant: ' : '‡™∏‡™π‡™æ‡™Ø‡™ï: ';
    document.getElementById('transcript').textContent = prefix + answerText;
    addMessage(answerText, 'bot');
    // speak answer
    speak(answerText, currentLang === 'en' ? 'en-IN' : 'gu-IN');
  }

  /* ---------------- recognition (speech-to-text) ---------------- */
  let recognition = null;
  let lastHeard = false;
  if(window.SpeechRecognition || window.webkitSpeechRecognition){
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    recognition = new SR();
    recognition.lang = 'en-IN';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.onresult = (e) => {
      lastHeard = true;
      const text = e.results[0][0].transcript;
      // show recognized text as user in chat and handle
      addMessage(text, 'user');
      handleUserQuery(text);
    };

    recognition.onend = () => {
      document.getElementById('mic').classList.remove('listening');
      if(!lastHeard){
        document.getElementById('transcript').textContent = (currentLang === 'en' ? 'Tap mic to speak' : '‡™Æ‡™æ‡™á‡™ï ‡™¶‡™¨‡™æ‡™µ‡´ã ‡™Ö‡™®‡´á ‡™¨‡´ã‡™≤‡´ã');
      }
      lastHeard = false;
    };

    recognition.onerror = (ev) => {
      document.getElementById('transcript').textContent = 'Error: ' + (ev.error || ev.message);
      document.getElementById('mic').classList.remove('listening');
      lastHeard = false;
    };
  }

  /* ---------------- main query handler ---------------- */
  function handleUserQuery(text){
    // try product prompts
    const pAns = matchProductPrompt(text);
    if(pAns){ respond(pAns); return; }
    const gAns = matchGlobal(text);
    if(gAns){ respond(gAns); return; }
    // fallback generic answer
    const fallback = currentLang === 'en' ? 'Sorry, I do not have that exact information. Ask about price, usage, water consumption, warranty or features.' : '‡™Æ‡™æ‡™´ ‡™ï‡™∞‡™∂‡´ã, ‡™Æ‡™æ‡™∞‡´Ä ‡™™‡™æ‡™∏‡´á ‡™§‡´á ‡™ö‡´ã‡™ï‡´ç‡™ï‡™∏ ‡™Æ‡™æ‡™π‡™ø‡™§‡´Ä ‡™â‡™™‡™≤‡™¨‡´ç‡™ß ‡™®‡™•‡´Ä. ‡™ï‡´É‡™™‡™æ ‡™ï‡™∞‡´Ä‡™®‡´á ‡™ï‡™ø‡™Ç‡™Æ‡™§, ‡™â‡™™‡™Ø‡´ã‡™ó, ‡™™‡™æ‡™£‡´Ä ‡™â‡™™‡™Ø‡´ã‡™ó, ‡™Ö‡™•‡™µ‡™æ ‡™µ‡´ã‡™∞‡™Ç‡™ü‡´Ä ‡™µ‡™ø‡™∂‡´á ‡™™‡´Ç‡™õ‡´ã.';
    respond(fallback);
  }

  /* ---------------- mic (main) behavior ---------------- */
  const micBtn = document.getElementById('mic');
  micBtn.addEventListener('click', () => {
    playTap();
    if(!recognition){
      const q = prompt(currentLang === 'en' ? 'Type your question:' : '‡™§‡™Æ‡™æ‡™∞‡´ã ‡™™‡´ç‡™∞‡™∂‡´ç‡™® ‡™≤‡™ñ‡´ã:');
      if(q){ addMessage(q, 'user'); handleUserQuery(q); }
      return;
    }
    recognition.lang = (currentLang === 'en') ? 'en-IN' : 'gu-IN';
    try{
      lastHeard = false;
      micBtn.classList.add('listening');
      document.getElementById('transcript').textContent = (currentLang === 'en') ? 'Listening...' : '‡™∂‡´Å‡™£‡™µ‡™æ‡™Æ‡™æ‡™Ç ‡™Ü‡™µ‡´Ä ‡™∞‡™π‡´ç‡™Ø‡´Å‡™Ç ‡™õ‡´á...';
      recognition.start();
    }catch(e){
      micBtn.classList.remove('listening');
      document.getElementById('transcript').textContent = (currentLang === 'en') ? 'Tap mic to speak' : '‡™Æ‡™æ‡™á‡™ï ‡™¶‡™¨‡™æ‡™µ‡´ã ‡™Ö‡™®‡´á ‡™¨‡´ã‡™≤‡´ã';
    }
  });
  micBtn.tabIndex = 0;
  micBtn.addEventListener('keydown', e => { if(e.key === 'Enter' || e.key === ' ') e.target.click(); });

  /* ---------------- chat typing & chat mic ---------------- */
  chatSend.addEventListener('click', ()=> {
    const text = chatInput.value.trim();
    if(!text) return;
    addMessage(text, 'user');
    chatInput.value = '';
    handleUserQuery(text);
  });
  chatInput.addEventListener('keydown', e => { if(e.key === 'Enter') { e.preventDefault(); chatSend.click(); } });

  chatMic.addEventListener('click', ()=>{
    playTap();
    if(!recognition){
      const q = prompt(currentLang === 'en' ? 'Type your question:' : '‡™§‡™Æ‡™æ‡™∞‡´ã ‡™™‡´ç‡™∞‡™∂‡´ç‡™® ‡™≤‡™ñ‡´ã:');
      if(q){ addMessage(q, 'user'); handleUserQuery(q); }
      return;
    }
    recognition.lang = (currentLang === 'en') ? 'en-IN' : 'gu-IN';
    try{
      lastHeard = false;
      // visually show listening on main mic as well
      micBtn.classList.add('listening');
      document.getElementById('transcript').textContent = (currentLang === 'en') ? 'Listening...' : '‡™∂‡´Å‡™£‡™µ‡™æ‡™Æ‡™æ‡™Ç ‡™Ü‡™µ‡´Ä ‡™∞‡™π‡´ç‡™Ø‡´Å‡™Ç ‡™õ‡´á...';
      recognition.start();
    }catch(e){}
  });

  /* ---------------- initial UI state ---------------- */
  setLang('en');
  document.getElementById('transcript').textContent = 'Assistant ready. Select language and tap mic to ask.';
  // preload images
  PRODUCT.images.forEach(src => { const i = new Image(); i.src = src; });

}); // DOMContentLoaded end
</script>
</body>
</html>
