<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kalindi ‚Äî TCL 43" P6K 4K HDR TV (43P6K)</title>
<link rel="icon" href="assets/ktpl-new-logo.png">
<style>
  /* Theme: deep twilight + electric cyan + warm accent */
  :root{
    --bg1:#031026;
    --bg2:#071428;
    --card:#071726;
    --muted:#9fb0c4;
    --accent1:#00e6d8; /* electric cyan */
    --accent2:#ff8a65; /* warm coral */
    --glass: rgba(255,255,255,0.03);
    --text:#e9f8ff;
    --soft-shadow: 0 16px 50px rgba(2,8,18,0.7);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  }

  html,body{height:100%;margin:0;background:
    radial-gradient(700px 360px at 12% 8%, rgba(0,230,216,0.02), transparent 8%),
    linear-gradient(180deg,var(--bg1),var(--bg2)); color:var(--text); -webkit-font-smoothing:antialiased;}

  .wrap{max-width:980px;margin:18px auto;padding:18px}

  header{display:flex;align-items:center;justify-content:space-between;gap:18px;margin-bottom:18px}
  .brand{display:flex;gap:14px;align-items:center}
  .logo{width:120px;height:120px;border-radius:16px;overflow:hidden;background:#fff;padding:10px;box-shadow:0 20px 60px rgba(0,0,0,0.6)}
  .logo img{width:100%;height:100%;object-fit:contain}
  .brand-info{line-height:1}
  .brand-name{font-weight:900;font-size:20px}
  .brand-sub{color:var(--muted);font-size:13px;margin-top:6px}

  .lang-toggle{display:flex;gap:10px}
  .lang{padding:8px 12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);cursor:pointer;font-weight:800}
  .lang.active{background:linear-gradient(90deg,var(--accent1),#6df0c8);color:#022426;box-shadow:0 12px 40px rgba(0,230,216,0.06)}

  /* main card */
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border-radius:18px;padding:14px;box-shadow:var(--soft-shadow)}
  .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
  @media (max-width:900px){ .grid{grid-template-columns:1fr} }

  /* gallery */
  .gallery{position:relative;border-radius:12px;overflow:hidden;background:linear-gradient(180deg,#071826,#041018)}
  .slides{display:flex;transition:transform .36s cubic-bezier(.2,.9,.2,1);touch-action:pan-y}
  .slides img{width:100%;height:420px;object-fit:cover;flex-shrink:0;cursor:zoom-in;transition:transform .28s ease}
  @media (max-width:520px){ .slides img{height:240px} }

  .dots{position:absolute;left:12px;bottom:12px;display:flex;gap:8px;z-index:12}
  .dot{width:10px;height:10px;border-radius:8px;background:rgba(255,255,255,0.06)}
  .dot.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));transform:scale(1.1)}

  /* prev/next overlay */
  .nav-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(2,6,12,0.46);border-radius:10px;padding:10px;border:0;color:white;cursor:pointer;z-index:20}
  .nav-btn:hover{background:rgba(2,6,12,0.7)}
  .nav-prev{left:12px}
  .nav-next{right:12px}

  /* product meta */
  .meta{padding:10px 0}
  .product-title{font-weight:900;font-size:20px;margin-bottom:6px}
  .price{display:inline-block;padding:8px 12px;border-radius:12px;background:linear-gradient(90deg, rgba(0,230,216,0.08), rgba(255,138,101,0.06));color:#021414;font-weight:900}

  .rating{color:var(--muted);font-size:13px;margin-top:6px}

  /* assistant */
  .assistant{display:flex;gap:14px;align-items:center;margin-top:14px;padding:14px;border-radius:14px;background:linear-gradient(90deg, rgba(0,230,216,0.03), rgba(255,138,101,0.02));box-shadow:0 12px 36px rgba(2,8,18,0.45)}
  .mic{width:68px;height:68px;border-radius:14px;background:linear-gradient(180deg,var(--accent1),#6df0c8);display:flex;align-items:center;justify-content:center;font-size:22px;color:#022426;cursor:pointer;border:0;box-shadow:0 10px 30px rgba(2,8,18,0.6)}
  .mic.listening{transform:scale(1.06);box-shadow:0 28px 70px rgba(0,230,216,0.12);animation:micPulse 1200ms infinite}
  @keyframes micPulse{0%{box-shadow:0 10px 30px rgba(0,230,216,0.04)}50%{box-shadow:0 28px 70px rgba(0,230,216,0.12)}100%{box-shadow:0 10px 30px rgba(0,230,216,0.04)}}
  .assistant-info{flex:1}
  .assistant-title{font-weight:800}
  .assistant-sub{font-size:13px;color:var(--muted);margin-top:6px}
  .transcript{margin-top:8px;color:var(--muted);font-size:14px;min-height:44px}

  /* chat area */
  .chat{margin-top:14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border-radius:14px;padding:12px;display:flex;flex-direction:column;gap:10px}
  .messages{max-height:260px;overflow:auto;display:flex;flex-direction:column;gap:10px;padding-right:6px}
  .bubble{padding:12px;border-radius:14px;max-width:78%;font-size:15px;line-height:1.4;word-break:break-word}
  .bubble.user{align-self:flex-end;background:linear-gradient(90deg,var(--accent1),#ffb085);color:#022426}
  .bubble.bot{align-self:flex-start;background:rgba(255,255,255,0.03);color:#e9f6fb}
  /* ensure bubbles don't overflow on small screens */
  .messages .bubble{box-shadow:0 6px 18px rgba(2,8,18,0.4)}
  .input-row{display:flex;gap:8px;align-items:center;margin-top:6px}
  .input-row input{flex:1;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;font-size:15px;outline:none}
  .btn-send{padding:10px 14px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#022426;cursor:pointer;font-weight:800}
  .btn-voice{padding:10px;border-radius:12px;border:0;background:transparent;color:var(--muted);cursor:pointer}

  /* features image area (below) */
  .details{margin-top:22px;display:grid;grid-template-columns:1fr 340px;gap:18px;align-items:start}
  @media (max-width:900px){ .details{grid-template-columns:1fr} }
  .desc-panel{background:linear-gradient(180deg, rgba(255,255,255,0.005), rgba(255,255,255,0.002));padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)}
  .feature-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:6px}
  .feature-grid img{width:100%;height:160px;object-fit:cover;border-radius:10px;cursor:zoom-in;box-shadow:0 12px 36px rgba(2,8,18,0.5);transform:translateY(18px);opacity:0;transition:transform .6s ease,opacity .6s ease}
  .feature-grid img.revealed{transform:none;opacity:1}

  .side-images{display:flex;flex-direction:column;gap:10px}
  .side-images img{width:100%;height:140px;object-fit:cover;border-radius:10px}

  /* lightbox */
  .lightbox{position:fixed;inset:0;background:rgba(2,6,12,0.92);display:flex;align-items:center;justify-content:center;z-index:9999;opacity:0;pointer-events:none;transition:opacity .24s ease}
  .lightbox.show{opacity:1;pointer-events:auto}
  .lightbox img{max-width:94%;max-height:94%;object-fit:contain;cursor:grab;transition:transform .12s ease}
  .closeBtn{position:fixed;top:16px;right:16px;background:rgba(255,255,255,0.06);border-radius:10px;padding:8px 10px;border:0;color:var(--text);cursor:pointer;z-index:10000}

  footer{margin-top:22px;color:var(--muted);font-size:13px;text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo"><img id="logo" src="assets/ktpl-new-logo.png" alt="Kalindi logo"></div>
        <div class="brand-info">
          <div class="brand-name">Kalindi Tradelinks Pvt Ltd</div>
          <div class="brand-sub">TV ‚Ä¢ Electronics</div>
        </div>
      </div>

      <div class="lang-toggle" role="tablist" aria-label="Language">
        <button class="lang active" id="lang-en">English</button>
        <button class="lang" id="lang-gu">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</button>
      </div>
    </header>

    <main class="card" role="main">
      <div class="grid">
        <div>
          <div class="gallery" id="gallery" aria-label="Product images">
            <button class="nav-btn nav-prev" id="prevBtn" aria-label="Previous image">‚óÄ</button>
            <div class="slides" id="slides"></div>
            <div class="dots" id="dots" aria-hidden="true"></div>
            <button class="nav-btn nav-next" id="nextBtn" aria-label="Next image">‚ñ∂</button>
          </div>

          <div class="meta">
            <div class="product-title" id="productTitle">TCL 43" P6K 4K HDR TV ‚Äî 43P6K</div>
            <div class="rating" id="rating">4.6 ‚òÖ ‚Ä¢ 1 year warranty</div>
            <div style="margin-top:8px" class="price" id="price">‚Çπ35,000</div>
          </div>

          <div class="assistant" role="region" aria-label="Voice assistant">
            <button class="mic" id="mainMic" title="Tap to speak" aria-pressed="false">üéôÔ∏è</button>
            <div class="assistant-info">
              <div class="assistant-title" id="assistantTitle">Product Voice Assistant</div>
              <div class="assistant-sub" id="assistantSub">Tap mic or type ‚Äî answers in English & Gujarati.</div>
              <div class="transcript" id="transcript">Assistant ready. Select language and tap mic or type your question.</div>
            </div>
          </div>

          <div class="chat" aria-live="polite">
            <div class="messages" id="messages" role="log" aria-relevant="additions"></div>
            <div class="input-row">
              <input id="chatInput" placeholder="Type your question..." autocomplete="off" />
              <button class="btn-send" id="sendBtn">Send</button>
              <button class="btn-voice" id="chatMic" title="Speak from chat">üéôÔ∏è</button>
            </div>
          </div>
        </div>

        <aside class="side-images" id="sideImages" aria-hidden="false">
          <!-- JS fills -->
        </aside>
      </div>

      <section class="details" id="details">
        <div class="desc-panel">
          <div class="desc-title" style="font-weight:800">Product Images & Features</div>
          <div class="feature-grid" id="featureGrid"></div>
        </div>

        <div>
          <div class="desc-panel" style="margin-bottom:12px">
            <div class="desc-title" style="font-weight:800">AI Images</div>
            <img src="assets/ai clarity.webp" alt="AI clarity" style="width:100%;border-radius:10px;margin-top:8px"/>
            <img src="assets/ai contrast.webp" alt="AI contrast" style="width:100%;border-radius:10px;margin-top:12px"/>
          </div>

          <div class="desc-panel">
            <div class="desc-title" style="font-weight:800">Dimensions & Display</div>
            <img src="assets/dimension.webp" alt="dimensions" style="width:100%;border-radius:10px;margin-top:8px"/>
            <img src="assets/display.webp" alt="display" style="width:100%;border-radius:10px;margin-top:12px"/>
          </div>
        </div>
      </section>
    </main>

    <footer>¬© Kalindi Tradelinks Pvt Ltd</footer>
  </div>

  <!-- lightbox -->
  <div id="lightbox" class="lightbox" role="dialog" aria-hidden="true">
    <button class="closeBtn" id="lbClose">Close ‚úï</button>
    <img id="lbImg" src="" alt="expanded image" />
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // PRODUCT
  const PRODUCT = {
    id:'tcl-43p6k',
    title: 'TCL 43" P6K 4K HDR TV ‚Äî 43P6K',
    price: '‚Çπ35,000',
    rating: '4.6 ‚òÖ ‚Ä¢ 1 year warranty',
    images: ['assets/wm1.jpg','assets/wm2.jpg','assets/wm3.jpg','assets/wm4.jpg','assets/wm5.jpg'],
    featureImages: ['assets/description1.webp','assets/description2.webp','assets/front2.webp','assets/proccessor.webp','assets/back4.webp','assets/side1.webp']
  };

  // populate UI text
  document.getElementById('productTitle').textContent = PRODUCT.title;
  document.getElementById('price').textContent = PRODUCT.price;
  document.getElementById('rating').textContent = PRODUCT.rating;

  // side images
  const sideImages = document.getElementById('sideImages'); sideImages.innerHTML = '';
  ['assets/front2.webp','assets/proccessor.webp','assets/side1.webp'].forEach(src => {
    const i = document.createElement('img'); i.src = src; i.alt = 'feature'; sideImages.appendChild(i);
  });

  // build slider + dots
  const slidesEl = document.getElementById('slides'), dotsEl = document.getElementById('dots');
  function buildSlides(){
    slidesEl.innerHTML=''; dotsEl.innerHTML='';
    PRODUCT.images.forEach((src,i)=>{
      const img = document.createElement('img'); img.src = src; img.alt = PRODUCT.title + ' ' + (i+1);
      img.addEventListener('error', ()=> img.style.display='none');
      img.addEventListener('click', ()=> openLightbox(src));
      slidesEl.appendChild(img);

      const d = document.createElement('div'); d.className = 'dot' + (i===0 ? ' active' : '');
      d.addEventListener('click', ()=> { index = i; updateSlide(); });
      dotsEl.appendChild(d);
    });
  }
  let index = 0;
  function updateSlide(){ slidesEl.style.transform = `translateX(${-index*100}%)`; Array.from(dotsEl.children).forEach((d,i)=>d.classList.toggle('active', i===index)); }
  buildSlides();
  let auto = setInterval(()=>{ if(slidesEl.children.length){ index=(index+1)%slidesEl.children.length; updateSlide(); } },4500);

  // prev/next
  document.getElementById('prevBtn').addEventListener('click', ()=>{ index = Math.max(0, index-1); updateSlide(); clearInterval(auto); auto = setInterval(()=>{ index=(index+1)%slidesEl.children.length; updateSlide(); },4500); });
  document.getElementById('nextBtn').addEventListener('click', ()=>{ index = Math.min(slidesEl.children.length-1, index+1); updateSlide(); clearInterval(auto); auto = setInterval(()=>{ index=(index+1)%slidesEl.children.length; updateSlide(); },4500); });

  // swipe support
  let startX = null;
  const gallery = document.getElementById('gallery');
  gallery.addEventListener('touchstart', e => startX = e.changedTouches[0].clientX);
  gallery.addEventListener('touchend', e => {
    if(startX === null) return;
    const endX = e.changedTouches[0].clientX; const dx = endX - startX;
    if(Math.abs(dx) > 40){
      if(dx < 0) index = Math.min(index+1, slidesEl.children.length-1); else index = Math.max(index-1, 0);
      updateSlide();
    }
    startX = null;
  });

  // feature grid
  const featureGrid = document.getElementById('featureGrid');
  PRODUCT.featureImages.forEach(src=>{
    const img = document.createElement('img'); img.src = src; img.alt = 'feature'; img.loading='lazy';
    img.addEventListener('click', ()=> openLightbox(src));
    featureGrid.appendChild(img);
  });
  // reveal on scroll
  const obs = new IntersectionObserver(entries=>{
    entries.forEach(ent=>{
      if(ent.isIntersecting) ent.target.querySelectorAll('img').forEach(img=>img.classList.add('revealed'));
    });
  },{threshold:0.22});
  obs.observe(document.getElementById('details'));

  // Lightbox (fit-to-screen initial)
  const lightbox = document.getElementById('lightbox'), lbImg = document.getElementById('lbImg'), lbClose = document.getElementById('lbClose');
  let isDragging=false, lastX=0, lastY=0, currentScale=1, translateX=0, translateY=0;
  function openLightbox(src){
    lbImg.src = src;
    currentScale = 1; translateX = 0; translateY = 0;
    lbImg.style.transform = `translate(0px,0px) scale(1)`;
    lightbox.classList.add('show'); lightbox.setAttribute('aria-hidden','false');
  }
  function closeLightbox(){ lightbox.classList.remove('show'); lightbox.setAttribute('aria-hidden','true'); lbImg.src=''; }
  lbClose.addEventListener('click', closeLightbox);
  lightbox.addEventListener('click', (e)=> { if(e.target === lightbox) closeLightbox(); });

  // wheel zoom
  lbImg.addEventListener('wheel', (e)=>{
    e.preventDefault();
    const delta = -e.deltaY * 0.0015;
    currentScale = Math.min(4, Math.max(1, currentScale + delta));
    lbImg.style.transform = `translate(${translateX}px,${translateY}px) scale(${currentScale})`;
  }, {passive:false});

  // drag to pan
  lbImg.addEventListener('mousedown', (e)=>{ isDragging=true; lastX=e.clientX; lastY=e.clientY; lbImg.style.cursor='grabbing'; });
  document.addEventListener('mouseup', ()=>{ isDragging=false; lbImg.style.cursor='grab'; });
  document.addEventListener('mousemove', (e)=>{ if(!isDragging) return; const dx=e.clientX-lastX, dy=e.clientY-lastY; lastX=e.clientX; lastY=e.clientY; translateX += dx; translateY += dy; lbImg.style.transform = `translate(${translateX}px,${translateY}px) scale(${currentScale})`; });

  // touch pinch zoom (basic)
  let touchStartDist = 0, touchStartScale = 1;
  lbImg.addEventListener('touchstart', (e)=>{ if(e.touches.length===2){ touchStartDist = Math.hypot(e.touches[0].clientX - e.touches[1].clientX, e.touches[0].clientY - e.touches[1].clientY); touchStartScale = currentScale; } }, {passive:true});
  lbImg.addEventListener('touchmove', (e)=>{ if(e.touches.length===2){ const d = Math.hypot(e.touches[0].clientX - e.touches[1].clientX, e.touches[0].clientY - e.touches[1].clientY); const factor = d / (touchStartDist || d); currentScale = Math.min(4, Math.max(1, touchStartScale * factor)); lbImg.style.transform = `translate(${translateX}px,${translateY}px) scale(${currentScale})`; } }, {passive:true});

  /* ---------------- language toggle ---------------- */
  let currentLang = 'en';
  const langEn = document.getElementById('lang-en'), langGu = document.getElementById('lang-gu');
  function setLang(l){
    currentLang = l;
    if(l==='en'){ langEn.classList.add('active'); langGu.classList.remove('active'); document.getElementById('assistantSub').textContent = 'Tap mic or type ‚Äî answers in English & Gujarati.'; }
    else { langGu.classList.add('active'); langEn.classList.remove('active'); document.getElementById('assistantSub').textContent = '‡™Æ‡™æ‡™á‡™ï ‡™¶‡™¨‡™æ‡™µ‡´ã ‡™Ö‡™•‡™µ‡™æ ‡™≤‡™ñ‡´ã ‚Äî ‡™ú‡™µ‡™æ‡™¨ ‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä ‡™Æ‡™æ‡™Ç.'; }
    if(recognition) recognition.lang = (currentLang==='en' ? 'en-IN' : 'gu-IN');
  }
  langEn.addEventListener('click', ()=> setLang('en'));
  langGu.addEventListener('click', ()=> setLang('gu'));

  /* ---------------- canned prompts ---------------- */
  const PROMPTS = [
    { q:/price|cost|‚Çπ|rupee/i, en:`The price of this model is ${PRODUCT.price}.`, gu:`‡™Ü ‡™Æ‡´ã‡™°‡´á‡™≤‡™®‡´Ä ‡™ï‡™ø‡™Ç‡™Æ‡™§ ${PRODUCT.price} ‡™õ‡´á.` },
    { q:/dimensions|dimension|size|height|width|depth/i, en:'Please check the dimensions image in the details section ‚Äî typical 43" TV dimensions are on the image.', gu:'‡™Æ‡™æ‡™™ ‡™Æ‡™æ‡™ü‡´á ‡™°‡™ø‡™ü‡´á‡™≤‡´ç‡™∏ ‡™∏‡´á‡™ï‡™∂‡™®‡™®‡´Å‡™Ç ‡™ö‡™ø‡™§‡´ç‡™∞ ‡™ú‡´Å‡™ì ‚Äî ‡™∏‡™æ‡™Æ‡™æ‡™®‡´ç‡™Ø 43" TV ‡™®‡™æ ‡™Æ‡™æ‡™™ ‡™Ö‡™π‡´Ä‡™Ç ‡™õ‡´á.' },
    { q:/features|feature|what .* include/i, en:'Key features: 4K UHD display, HDR10, Google TV smart platform, AiPQ processor (models vary).', gu:'‡™Æ‡´Å‡™ñ‡´ç‡™Ø ‡™´‡´Ä‡™ö‡™∞‡´ç‡™∏: 4K UHD, HDR10, Google TV ‡™™‡™ø‡™≤‡´á‡™ü‡™´‡´ã‡™∞‡´ç‡™Æ, AiPQ ‡™™‡´ç‡™∞‡´ã‡™∏‡´á‡™∏‡™∞ (‡™Æ‡´ã‡™°‡´á‡™≤ ‡™™‡´ç‡™∞‡™Æ‡™æ‡™£‡´á ‡™¨‡™¶‡™≤‡™æ‡™Ø).' },
    { q:/colour|color|available color/i, en:'Available colours depend on stock; common finishes are black/dark grey framing.', gu:'‡™∞‡™Ç‡™ó ‡™∏‡´ç‡™ü‡´ã‡™ï ‡™™‡™∞ ‡™Ü‡™ß‡™æ‡™∞ ‡™∞‡™æ‡™ñ‡´á ‡™õ‡´á; ‡™∏‡™æ‡™Æ‡™æ‡™®‡´ç‡™Ø ‡™∞‡´Ä‡™§‡´á ‡™¨‡´ç‡™≤‡´á‡™ï/‡™°‡™æ‡™∞‡´ç‡™ï ‡™ó‡´ç‡™∞‡´á ‡™´‡™ø‡™®‡™ø‡™∂ ‡™µ‡™ø‡™ß‡´á‡™Ø‡™®‡™æ ‡™π‡´ã‡™Ø ‡™õ‡´á.' },
    { q:/energy|power|watt|consumption/i, en:'Power consumption varies by model and usage; typical 43" LED TVs use ~70‚Äì120W during operation.', gu:'‡™â‡™∞‡´ç‡™ú‡™æ ‡™µ‡™™‡™∞‡™æ‡™∂ ‡™Æ‡´ã‡™°‡´á‡™≤ ‡™Ö‡™®‡´á ‡™â‡™™‡™Ø‡´ã‡™ó ‡™Æ‡´Å‡™ú‡™¨ ‡™¨‡™¶‡™≤‡™æ‡™Ø; ‡™∏‡™æ‡™Æ‡™æ‡™®‡´ç‡™Ø 43" TV ‡™≤‡™ó‡™≠‡™ó 70‚Äì120W ‡™â‡™™‡™Ø‡´ã‡™ó ‡™ï‡™∞‡´á ‡™õ‡´á.' },
    { q:/warrant|guarantee/i, en:'This product includes 1 year manufacturer warranty. Contact the store for extended plans.', gu:'‡™Ü ‡™â‡™§‡´ç‡™™‡™æ‡™¶‡™® ‡™∏‡™æ‡™•‡´á 1 ‡™µ‡™∞‡´ç‡™∑‡™®‡´Ä ‡™Æ‡´á‡™®‡´ç‡™Ø‡´Å‡™´‡´á‡™ï‡´ç‡™ö‡™∞‡™∞ ‡™µ‡´ã‡™∞‡™Ç‡™ü‡´Ä ‡™Æ‡™≥‡´á ‡™õ‡´á.' },
    { q:/display|hdr|4k/i, en:'Display: 4K UHD with HDR10 support for improved dynamic range and vivid colors.', gu:'‡™°‡™ø‡™∏‡´ç‡™™‡´ç‡™≤‡´á: 4K UHD HDR10 ‡™∏‡™™‡´ã‡™∞‡´ç‡™ü ‡™∏‡™æ‡™•‡´á.' },
    { q:/stock|available/i, en:'Stock levels vary; please contact the store for real-time availability.', gu:'‡™∏‡´ç‡™ü‡´ã‡™ï ‡™™‡™∞ ‡™Ü‡™ß‡™æ‡™∞ ‡™õ‡´á; ‡™µ‡™æ‡™∏‡´ç‡™§‡™µ‡™ø‡™ï ‡™â‡™™‡™≤‡™¨‡´ç‡™ß‡™§‡™æ ‡™Æ‡™æ‡™ü‡´á ‡™∏‡´ç‡™ü‡´ã‡™∞ ‡™µ‡´ç‡™Ø‡™ï‡´ç‡™§‡™ø ‡™∏‡™æ‡™•‡´á ‡™∏‡™Ç‡™™‡™∞‡´ç‡™ï ‡™ï‡™∞‡´ã.' },
    { q:/.*/, en:'Sorry, I don\'t have that exact information. Ask about price, features, display, dimensions or warranty.', gu:'‡™Æ‡™æ‡™´ ‡™ï‡™∞‡™∂‡´ã, ‡™Æ‡™æ‡™∞‡´Ä ‡™™‡™æ‡™∏‡´á ‡™§‡´á ‡™ö‡´ã‡™ï‡´ç‡™ï‡™∏ ‡™Æ‡™æ‡™π‡™ø‡™§‡´Ä ‡™®‡™•‡´Ä. ‡™ï‡´É‡™™‡™æ ‡™ï‡™∞‡´Ä‡™®‡´á ‡™ï‡™ø‡™Ç‡™Æ‡™§, ‡™´‡´Ä‡™ö‡™∞‡´ç‡™∏ ‡™Ö‡™•‡™µ‡™æ ‡™µ‡´ã‡™∞‡™Ç‡™ü‡´Ä ‡™µ‡™ø‡™∂‡´á ‡™™‡´Ç‡™õ‡´ã.' }
  ];

  function findAnswer(text){
    const q = text.toLowerCase();
    for(const p of PROMPTS) if(p.q.test(q)) return (currentLang==='en' ? p.en : p.gu);
    return null;
  }

  /* ---------------- speech synthesis & tap sound ---------------- */
  function speak(text){
    if(!('speechSynthesis' in window)) return;
    const u = new SpeechSynthesisUtterance(text);
    u.lang = (currentLang==='en' ? 'en-IN' : 'gu-IN');
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(u);
  }
  let audioCtx = null;
  function playTap(){
    try{
      if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const now = audioCtx.currentTime;
      const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
      o.type = 'sine'; o.frequency.setValueAtTime(1200, now);
      g.gain.setValueAtTime(0, now); g.gain.linearRampToValueAtTime(0.12, now + 0.002); g.gain.exponentialRampToValueAtTime(0.001, now + 0.12);
      o.connect(g); g.connect(audioCtx.destination); o.start(now); o.stop(now + 0.14);
    }catch(e){}
  }

  /* ---------------- speech recognition (optional) ---------------- */
  let recognition = null; let heard=false;
  if(window.SpeechRecognition || window.webkitSpeechRecognition){
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    recognition = new SR(); recognition.lang = 'en-IN'; recognition.interimResults=false; recognition.maxAlternatives=1;
    recognition.onresult = (e)=>{ heard=true; const txt = e.results[0][0].transcript; addMessage(txt,'user'); handleQuery(txt); };
    recognition.onend = ()=>{ document.getElementById('mainMic').classList.remove('listening'); if(!heard) document.getElementById('transcript').textContent = (currentLang==='en' ? 'Tap mic to speak' : '‡™Æ‡™æ‡™á‡™ï ‡™¶‡™¨‡™æ‡™µ‡´ã ‡™Ö‡™®‡´á ‡™¨‡´ã‡™≤‡´ã'); heard=false; };
    recognition.onerror = (e)=>{ document.getElementById('transcript').textContent = 'Error: ' + (e.error || e.message); document.getElementById('mainMic').classList.remove('listening'); heard=false; };
  }

  /* ---------------- chat UI ---------------- */
  const messages = document.getElementById('messages');
  function addMessage(text, who='user'){
    const b = document.createElement('div'); b.className = 'bubble ' + (who==='user' ? 'user' : 'bot'); b.textContent = text;
    messages.appendChild(b); messages.scrollTop = messages.scrollHeight;
  }
  function respond(text){
    if(!text) text = (currentLang==='en' ? "Sorry, I don't have that info. Ask about price, features, display, dimensions or warranty." : "‡™Æ‡™æ‡™´ ‡™ï‡™∞‡™∂‡´ã, ‡™Æ‡™æ‡™∞‡´Ä ‡™™‡™æ‡™∏‡´á ‡™§‡´á ‡™Æ‡™æ‡™π‡™ø‡™§‡´Ä ‡™®‡™•‡´Ä. ‡™ï‡´É‡™™‡™æ ‡™ï‡™∞‡´Ä‡™®‡´á ‡™¨‡´Ä‡™ú‡™æ ‡™™‡´ç‡™∞‡™∂‡´ç‡™® ‡™™‡´Ç‡™õ‡´ã.");
    document.getElementById('transcript').textContent = (currentLang==='en' ? 'Assistant: ' : '‡™∏‡™π‡™æ‡™Ø‡™ï: ') + text;
    addMessage(text, 'bot');
    speak(text);
  }

  function handleQuery(text){
    const ans = findAnswer(text);
    if(ans){ respond(ans); } else { respond(null); }
  }

  // main mic click
  const mainMic = document.getElementById('mainMic');
  mainMic.addEventListener('click', ()=>{
    playTap();
    if(!recognition){
      const q = prompt(currentLang==='en' ? 'Type your question:' : '‡™§‡™Æ‡™æ‡™∞‡´ã ‡™™‡´ç‡™∞‡™∂‡´ç‡™® ‡™≤‡™ñ‡´ã:');
      if(q){ addMessage(q,'user'); handleQuery(q); }
      return;
    }
    mainMic.classList.add('listening');
    document.getElementById('transcript').textContent = (currentLang==='en' ? 'Listening...' : '‡™∂‡´Å‡™£‡™µ‡™æ‡™Æ‡™æ‡™Ç ‡™Ü‡™µ‡´Ä ‡™∞‡™π‡´ç‡™Ø‡´Å‡™Ç ‡™õ‡´á...');
    heard=false;
    recognition.lang = (currentLang==='en' ? 'en-IN' : 'gu-IN');
    try{ recognition.start(); }catch(e){ mainMic.classList.remove('listening'); }
  });

  // chat send and chat mic
  const chatInput = document.getElementById('chatInput'), sendBtn = document.getElementById('sendBtn'), chatMic = document.getElementById('chatMic');
  sendBtn.addEventListener('click', ()=>{ const v = chatInput.value.trim(); if(!v) return; addMessage(v,'user'); chatInput.value=''; handleQuery(v); });
  chatInput.addEventListener('keydown', e => { if(e.key === 'Enter'){ e.preventDefault(); sendBtn.click(); }});
  chatMic.addEventListener('click', ()=>{
    playTap();
    if(!recognition){
      const q = prompt(currentLang==='en' ? 'Type your question:' : '‡™§‡™Æ‡™æ‡™∞‡´ã ‡™™‡´ç‡™∞‡™∂‡´ç‡™® ‡™≤‡™ñ‡´ã:');
      if(q){ addMessage(q,'user'); handleQuery(q); } return;
    }
    mainMic.classList.add('listening');
    document.getElementById('transcript').textContent = (currentLang==='en' ? 'Listening...' : '‡™∂‡´Å‡™£‡™µ‡™æ‡™Æ‡™æ‡™Ç ‡™Ü‡™µ‡´Ä ‡™∞‡™π‡´ç‡™Ø‡´Å‡™Ç ‡™õ‡´á...');
    heard=false; recognition.lang = (currentLang==='en' ? 'en-IN' : 'gu-IN');
    try{ recognition.start(); }catch(e){ mainMic.classList.remove('listening'); }
  });

  // init default language and transcript
  setLang('en');
  document.getElementById('transcript').textContent = 'Assistant ready. Select language and tap mic or type your question.';
});
</script>
</body>
</html>
