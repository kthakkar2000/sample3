<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kalindi â€” Samsung washing machine 12kg</title>
<link rel="icon" href="assets/ktpl-new-logo.png">
<style>
  /* ---------- Theme: modern deep navy + warm accent ---------- */
  :root{
    --bg-1:#051026;
    --bg-2:#071424;
    --card:#071526;
    --muted:#9fb0c4;
    --accent1:#ff6b6b;
    --accent2:#ffd166;
    --glass: rgba(255,255,255,0.03);
    --text:#e9f7ff;
    --soft:#0b2330;
    font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
  }
  html,body{height:100%;margin:0;background:
    radial-gradient(700px 360px at 12% 8%, rgba(255,107,107,0.03), transparent 8%),
    linear-gradient(180deg,var(--bg-1),var(--bg-2)); color:var(--text); -webkit-font-smoothing:antialiased;}

  .wrap{max-width:980px;margin:18px auto;padding:18px}

  header{display:flex;align-items:center;justify-content:space-between;gap:18px;margin-bottom:18px}
  .brand{display:flex;gap:16px;align-items:center}
  .logo{width:110px;height:110px;border-radius:14px;overflow:hidden;background:#fff;padding:10px;box-shadow:0 18px 60px rgba(3,6,12,0.6)}
  .logo img{width:100%;height:100%;object-fit:contain}
  .brand-info{line-height:1}
  .brand-name{font-weight:900;font-size:20px}
  .brand-sub{color:var(--muted);font-size:13px;margin-top:4px}

  .lang-toggle{display:flex;gap:10px}
  .lang{padding:8px 12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);cursor:pointer;font-weight:800}
  .lang.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#061016;box-shadow:0 12px 36px rgba(255,107,107,0.06);transform:translateY(-1px)}

  /* main product / card */
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:18px;padding:14px;box-shadow:0 20px 60px rgba(2,8,18,0.7)}
  .grid{display:grid;grid-template-columns:1fr 380px;gap:18px}
  @media (max-width:900px){ .grid{grid-template-columns:1fr; } }

  /* gallery */
  .gallery{position:relative;border-radius:12px;overflow:hidden;background:linear-gradient(180deg,#041218,#061428)}
  .slides{display:flex;transition:transform .36s cubic-bezier(.2,.9,.2,1);touch-action:pan-y}
  .slides img{width:100%;height:420px;object-fit:cover;flex-shrink:0;cursor:zoom-in;transition:transform .28s ease}
  @media (max-width:520px){ .slides img{height:260px} }

  .dots{position:absolute;left:12px;bottom:12px;display:flex;gap:8px;z-index:12}
  .dot{width:10px;height:10px;border-radius:8px;background:rgba(255,255,255,0.06);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
  .dot.active{background:linear-gradient(90deg,var(--accent1),var(--accent2));transform:scale(1.1);box-shadow:0 10px 28px rgba(255,107,107,0.12)}

  .meta{padding:6px 0}
  .product-title{font-weight:900;font-size:20px;margin-bottom:6px}
  .price{font-weight:900;color:var(--accent2);display:inline-block;padding:6px 10px;border-radius:10px;background:linear-gradient(90deg, rgba(255,209,102,0.06), rgba(255,107,107,0.02));}

  .rating{color:var(--muted);font-size:13px;margin-top:6px}

  .specs{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
  .spec{background:var(--glass);padding:10px;border-radius:10px;font-size:13px;color:var(--text);border:1px solid rgba(255,255,255,0.02);min-width:120px}

  /* assistant & chat */
  .assistant{display:flex;gap:14px;align-items:center;margin-top:14px;padding:12px;border-radius:12px;background:linear-gradient(90deg, rgba(255,107,107,0.04), rgba(255,209,102,0.02));box-shadow:0 12px 36px rgba(2,8,18,0.5)}
  .mic{width:64px;height:64px;border-radius:14px;background:linear-gradient(180deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:22px;color:#061016;cursor:pointer;border:0;box-shadow:0 12px 30px rgba(2,8,18,0.5)}
  .mic.listening{transform:scale(1.06);box-shadow:0 28px 70px rgba(255,107,107,0.16);animation:micPulse 1200ms infinite}
  @keyframes micPulse{0%{box-shadow:0 12px 30px rgba(255,107,107,0.08)}50%{box-shadow:0 28px 70px rgba(255,107,107,0.18)}100%{box-shadow:0 12px 30px rgba(255,107,107,0.08)}}
  .assistant-info{flex:1}
  .assistant-title{font-weight:800}
  .assistant-sub{font-size:13px;color:var(--muted);margin-top:6px}
  .transcript{margin-top:8px;color:var(--muted);font-size:14px;min-height:44px}

  /* chat */
  .chat{margin-top:14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:10px}
  .messages{max-height:220px;overflow:auto;display:flex;flex-direction:column;gap:10px;padding-right:6px}
  .bubble{padding:10px 12px;border-radius:12px;max-width:80%;font-size:14px;line-height:1.35}
  .bubble.user{align-self:flex-end;background:linear-gradient(90deg,var(--accent2),#ffb085);color:#061016;font-weight:800}
  .bubble.bot{align-self:flex-start;background:rgba(255,255,255,0.04);color:#e9f6fb}
  .input-row{display:flex;gap:8px;align-items:center}
  .input-row input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;font-size:14px}
  .btn-send{padding:10px 14px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#061016;cursor:pointer;font-weight:900}
  .btn-voice{padding:10px;border-radius:10px;border:0;background:transparent;color:var(--muted);cursor:pointer}

  /* details / feature gallery */
  .details{margin-top:22px;display:grid;grid-template-columns:1fr 340px;gap:18px;align-items:start}
  @media (max-width:900px){ .details{grid-template-columns:1fr; } }
  .desc-panel{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)}
  .desc-title{font-weight:800;margin-bottom:8px}
  .desc-text{color:var(--muted);line-height:1.5;font-size:14px}
  .feature-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
  .feature-grid img{width:100%;height:140px;object-fit:cover;border-radius:10px;box-shadow:0 12px 36px rgba(2,8,18,0.5);transform:translateY(18px);opacity:0;transition:transform .6s ease,opacity .6s ease}
  .feature-grid img.revealed{transform:none;opacity:1}

  /* right side: tall product images */
  .side-images{display:flex;flex-direction:column;gap:10px}
  .side-images img{width:100%;height:160px;object-fit:cover;border-radius:10px;box-shadow:0 12px 36px rgba(2,8,18,0.5)}

  /* lightbox fullscreen */
  .lightbox{position:fixed;inset:0;background:rgba(2,6,12,0.85);display:flex;align-items:center;justify-content:center;z-index:9999;opacity:0;pointer-events:none;transition:opacity .28s ease}
  .lightbox.show{opacity:1;pointer-events:auto}
  .lightbox img{max-width:92%;max-height:92%;cursor:grab;transition:transform .12s ease}
  .closeBtn{position:fixed;top:18px;right:18px;background:rgba(255,255,255,0.06);border-radius:10px;padding:8px 10px;border:0;color:var(--text);cursor:pointer;z-index:10000}

  /* small utility */
  footer{margin-top:22px;color:var(--muted);font-size:13px;text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo"><img id="logo" src="assets/ktpl-new-logo.png" alt="Kalindi logo"></div>
        <div class="brand-info">
          <div class="brand-name">Kalindi Tradelinks Pvt Ltd</div>
          <div class="brand-sub">Home Appliances â€¢ Washing Machine</div>
        </div>
      </div>

      <div class="lang-toggle" role="tablist" aria-label="Language">
        <button class="lang active" id="lang-en">English</button>
        <button class="lang" id="lang-gu">àª—à«àªœàª°àª¾àª¤à«€</button>
      </div>
    </header>

    <main class="card" role="main">
      <div class="grid">
        <!-- left: gallery -->
        <div>
          <div class="gallery" id="gallery" aria-label="Product images">
            <div class="slides" id="slides" aria-hidden="false"></div>
            <div class="dots" id="dots" aria-hidden="true"></div>
          </div>

          <div class="meta">
            <div class="product-title" id="productTitle">Samsung washing machine 12kg</div>
            <div class="rating" id="rating">4.7 â˜… â€¢ 2 year warranty</div>
            <div style="margin-top:8px" class="price" id="price">â‚¹65,000</div>
            <div class="specs" id="specs"></div>
          </div>

          <div class="assistant" role="region" aria-label="Voice assistant">
            <button class="mic" id="mainMic" title="Tap to speak" aria-pressed="false">ğŸ™ï¸</button>
            <div class="assistant-info">
              <div class="assistant-title" id="assistantTitle">Product Voice Assistant</div>
              <div class="assistant-sub" id="assistantSub">Tap mic or type â€” answers in English & Gujarati.</div>
              <div class="transcript" id="transcript">Assistant ready. Select language and tap mic or type your question.</div>
            </div>
          </div>

          <div class="chat" aria-live="polite">
            <div class="messages" id="messages" role="log" aria-relevant="additions"></div>
            <div class="input-row">
              <input id="chatInput" placeholder="Type your question..." autocomplete="off" />
              <button class="btn-send" id="sendBtn">Send</button>
              <button class="btn-voice" id="chatMic" title="Speak from chat">ğŸ™ï¸</button>
            </div>
          </div>
        </div>

        <!-- right: side images / quick specs -->
        <aside class="side-images" id="sideImages" aria-hidden="false">
          <!-- filled by JS -->
        </aside>
      </div>

      <!-- details & AI images -->
      <section class="details" id="details">
        <div class="desc-panel">
          <div class="desc-title">Product Details</div>
          <div class="desc-text" id="descText">
            Samsung 12 kg front-load washing machine â€” efficient Digital Inverter motor, multiple wash programs including Quick and Eco, quiet operation and smart features on select models. Scroll the right to see AI-clarity images, display, processor and dimension visuals.
          </div>

          <div class="feature-grid" id="featureGrid">
            <!-- images added by JS, they will animate in when scrolled -->
          </div>
        </div>

        <div>
          <!-- tall list / gallery on right -->
          <div class="desc-panel" style="margin-bottom:12px">
            <div class="desc-title">AI & Feature Images</div>
            <img src="assets/ai clarity.webp" alt="AI clarity" style="width:100%;border-radius:10px;margin-top:8px"/>
            <img src="assets/ai contrast.webp" alt="AI contrast" style="width:100%;border-radius:10px;margin-top:12px"/>
          </div>

          <div class="desc-panel">
            <div class="desc-title">Dimensions & Display</div>
            <img src="assets/dimension.webp" alt="dimensions" style="width:100%;border-radius:10px;margin-top:8px"/>
            <img src="assets/display.webp" alt="display" style="width:100%;border-radius:10px;margin-top:12px"/>
          </div>
        </div>
      </section>

    </main>

    <footer>Â© Kalindi Tradelinks Pvt Ltd</footer>
  </div>

  <!-- lightbox -->
  <div id="lightbox" class="lightbox" role="dialog" aria-hidden="true">
    <button class="closeBtn" id="lbClose">Close âœ•</button>
    <img id="lbImg" src="" alt="expanded image" />
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  /* ---------------- product configuration ---------------- */
  const PRODUCT = {
    id: 'samsung-12kg',
    title: 'Samsung washing machine 12kg',
    price: 'â‚¹65,000',
    rating: '4.7 â˜… â€¢ 2 year warranty',
    images: ['assets/wm1.jpg','assets/wm2.jpg','assets/wm3.jpg','assets/wm4.jpg','assets/wm5.jpg'],
    specs: { Capacity:'12 kg', Energy:'5 Star', RPM:'1200', Warranty:'2 years' },
    description_en: 'Samsung 12 kg front-load washers combine AI wash optimisation, Digital Inverter motor, Quick/Eco programs, and SmartThings on select models.',
    description_gu: 'Samsung 12 kg àª«à«àª°àª¨à«àªŸ-àª²à«‹àª¡ àªµà«‹àª¶àª°à«àª¸àª®àª¾àª‚ AI àªµà«‹àª¶, àª¡àª¿àªœàª¿àªŸàª² àª‡àª¨àªµàª°à«àªŸàª° àª®à«‹àªŸàª°, àª•à«àªµàª¿àª•/àªàª•à«‹ àªªà«àª°à«‹àª—à«àª°àª¾àª® àª…àª¨à«‡ SmartThings àª¸àªªà«‹àª°à«àªŸ àª¹à«‹àª¯ àª›à«‡.',
    featureImages: [
      'assets/description1.webp','assets/description2.webp','assets/front2.webp','assets/proccessor.webp',
      'assets/back4.webp','assets/side1.webp'
    ]
  };

  /* ------------- populate UI ------------- */
  document.getElementById('productTitle').textContent = PRODUCT.title;
  document.getElementById('price').textContent = PRODUCT.price;
  document.getElementById('rating').textContent = PRODUCT.rating;

  // specs
  const specsEl = document.getElementById('specs');
  specsEl.innerHTML = '';
  for(const [k,v] of Object.entries(PRODUCT.specs)){
    const s = document.createElement('div'); s.className = 'spec'; s.innerHTML = `<strong>${k}</strong><div style="color:var(--muted);margin-top:6px">${v}</div>`; specsEl.appendChild(s);
  }

  // side images
  const sideImages = document.getElementById('sideImages');
  sideImages.innerHTML = '';
  ['assets/front2.webp','assets/proccessor.webp','assets/side1.webp'].forEach(src=>{
    const i=document.createElement('img'); i.src=src; i.alt='feature'; sideImages.appendChild(i);
  });

  /* ------------- slider build ------------- */
  const slidesEl = document.getElementById('slides'), dotsEl = document.getElementById('dots');
  function buildSlides(){
    slidesEl.innerHTML=''; dotsEl.innerHTML='';
    PRODUCT.images.forEach((src,i)=>{
      const img=document.createElement('img');
      img.src=src; img.alt = PRODUCT.title + ' image ' + (i+1);
      img.addEventListener('error', ()=>{ img.style.display='none'; });
      // click -> open lightbox
      img.addEventListener('click', ()=> openLightbox(src));
      // hover zoom on desktop: scale on hover
      slidesEl.appendChild(img);

      const d=document.createElement('div'); d.className = 'dot' + (i===0 ? ' active' : '');
      d.addEventListener('click', ()=> { idx = i; updateSlide(); });
      dotsEl.appendChild(d);
    });
  }
  let idx = 0;
  function updateSlide(){ slidesEl.style.transform = `translateX(${-idx*100}%)`; Array.from(dotsEl.children).forEach((d,i)=> d.classList.toggle('active', i===idx)); }
  buildSlides();
  setInterval(()=> { if(slidesEl.children.length){ idx = (idx+1) % slidesEl.children.length; updateSlide(); } }, 4500);

  // swipe support for mobile
  let startX = null;
  const gallery = document.getElementById('gallery');
  gallery.addEventListener('touchstart', e => startX = e.changedTouches[0].clientX);
  gallery.addEventListener('touchend', e => {
    if(startX === null) return;
    const endX = e.changedTouches[0].clientX; const dx = endX - startX;
    if(Math.abs(dx) > 40){
      if(dx < 0) idx = Math.min(idx+1, slidesEl.children.length-1); else idx = Math.max(idx-1,0);
      updateSlide();
    }
    startX = null;
  });

  /* ------------- feature grid (reveal on scroll) ------------- */
  const featureGrid = document.getElementById('featureGrid');
  PRODUCT.featureImages.forEach(src=>{
    const img = document.createElement('img'); img.src = src;
    img.alt = 'feature';
    img.loading = 'lazy';
    img.addEventListener('click', ()=> openLightbox(src));
    featureGrid.appendChild(img);
  });

  // intersection observer for reveal
  const obs = new IntersectionObserver(entries=>{
    entries.forEach(ent=>{
      if(ent.isIntersecting){
        ent.target.querySelectorAll('img').forEach(img=>img.classList.add('revealed'));
      }
    });
  }, {threshold:0.22});
  obs.observe(document.getElementById('details'));

  /* ------------- lightbox + pan/zoom ------------- */
  const lightbox = document.getElementById('lightbox'), lbImg = document.getElementById('lbImg'), lbClose = document.getElementById('lbClose');
  let isDragging=false, lastX=0, lastY=0, currentScale=1, startScale=1;
  function openLightbox(src){
    lbImg.src = src;
    lightbox.classList.add('show'); lightbox.setAttribute('aria-hidden','false');
    currentScale = 1; lbImg.style.transform = 'translate(0px,0px) scale(1)';
  }
  function closeLightbox(){ lightbox.classList.remove('show'); lightbox.setAttribute('aria-hidden','true'); lbImg.src=''; }
  lbClose.addEventListener('click', closeLightbox);
  lightbox.addEventListener('click', (e)=> { if(e.target === lightbox) closeLightbox(); });

  // basic pan/zoom for desktop
  lbImg.addEventListener('wheel', (e)=>{
    e.preventDefault();
    const delta = -e.deltaY * 0.0015;
    currentScale = Math.min(4, Math.max(1, currentScale + delta));
    lbImg.style.transform = `translate(0px,0px) scale(${currentScale})`;
  });
  // drag to pan
  lbImg.addEventListener('mousedown', (e)=>{
    isDragging = true; lastX = e.clientX; lastY = e.clientY; lbImg.style.cursor = 'grabbing';
  });
  document.addEventListener('mouseup', ()=>{ isDragging=false; lbImg.style.cursor='grab'; });
  document.addEventListener('mousemove', (e)=>{
    if(!isDragging) return;
    const dx = e.clientX - lastX, dy = e.clientY - lastY;
    lastX = e.clientX; lastY = e.clientY;
    // read current translate from style
    const transform = lbImg.style.transform || 'translate(0px,0px) scale(1)';
    const m = transform.match(/translate\((-?\d+)px,(-?\d+)px\)\s*scale\(([\d.]+)\)/);
    let tx=0, ty=0, sc=1;
    if(m){ tx = parseFloat(m[1]) + dx; ty = parseFloat(m[2]) + dy; sc = parseFloat(m[3]); }
    lbImg.style.transform = `translate(${tx}px,${ty}px) scale(${sc})`;
  });

  /* ------------- language toggle ------------- */
  let currentLang = 'en';
  const langEn = document.getElementById('lang-en'), langGu = document.getElementById('lang-gu');
  function setLang(l){
    currentLang = l;
    if(l==='en'){ langEn.classList.add('active'); langGu.classList.remove('active'); document.getElementById('assistantSub').textContent='Tap mic or type â€” answers in English & Gujarati.'; }
    else { langGu.classList.add('active'); langEn.classList.remove('active'); document.getElementById('assistantSub').textContent='àª®àª¾àª‡àª• àª¦àª¬àª¾àªµà«‹ àª…àª¥àªµàª¾ àª²àª–à«‹ â€” jawab àª—à«àªœàª°àª¾àª¤à«€ àª®àª¾àª‚.'; }
    if(recognition) recognition.lang = (currentLang==='en' ? 'en-IN' : 'gu-IN');
  }
  langEn.addEventListener('click', ()=> setLang('en'));
  langGu.addEventListener('click', ()=> setLang('gu'));

  /* ------------- canned prompts (product-specific) ------------- */
  const PRODUCT_PROMPTS = [
    { q: /price|cost|â‚¹|rupee/i, en: `The price of this model is ${PRODUCT.price}.`, gu: `àª† àª®à«‹àª¡à«‡àª²àª¨à«€ àª•àª¿àª‚àª®àª¤ ${PRODUCT.price} àª›à«‡.` },
    { q: /stock|available/i, en: 'Stock varies by store. Please contact us to confirm availability.', gu: 'àª¸à«àªŸà«‹àª• àª¸à«àªŸà«‹àª°à«àª¸ àªªàª° àª¬àª¦àª²àª¾àª¯ àª›à«‡. àª•à«ƒàªªàª¾ àª•àª°à«€àª¨à«‡ àª¸à«àªŸà«‹àª° àª¤àªªàª¾àª¸à«‹.' },
    { q: /warrant(?:y|ies)|guarantee/i, en: 'This product comes with a 2 year manufacturer warranty covering defects and parts.', gu: 'àª† àªªà«àª°à«‹àª¡àª•à«àªŸ àª¸àª¾àª¥à«‡ 2 àªµàª°à«àª·àª¨à«€ àªµà«‹àª°àª‚àªŸà«€ àª®àª³à«‡ àª›à«‡.' },
    { q: /usage|how to use|how do i use/i, en: 'Load clothes evenly, use recommended detergent, select the correct program and avoid overloading.', gu: 'àª•àªªàª¡àª¾ àª¸àª® àª®àª¿àªŸ àª•àª°à«‹, àª¯à«‹àª—à«àª¯ àªªà«àª°à«‹àª—à«àª°àª¾àª® àªªàª¸àª‚àª¦ àª•àª°à«‹ àª…àª¨à«‡ àª“àªµàª°àª²à«‹àª¡ àª¨ àª•àª°à«‹.' },
    { q: /water|litre|consumption/i, en: 'Approx 50â€“70 litres per full wash depending on program.', gu: 'àªªà«àª°à«‹àª—à«àª°àª¾àª® àª†àª§àª¾àª°àª¿àª¤ ~50â€“70 àª²à«€àªŸàª°àª¨à«€ àªªàª¾àª£à«€ àªµàªªàª°àª¾àª¯. ' },
    { q: /colour|color|available color/i, en: 'Common colours: Pearl White, Graphite Silver; availability depends on stock.', gu: 'àªªà«àª°àª¾àªªà«àª¤ àª°àª‚àª—à«‹: àªªàª°à«àª² àªµà«àª¹àª¾àªˆàªŸ, àª—à«àª°àª¾àª«àª¾àª‡àªŸ àª¸àª¿àª²à«àªµàª° â€” àª¸à«àªŸà«‹àª• àªªàª° àª†àª§àª¾àª°.' },
    { q: /dimension|size|height|width|depth/i, en: 'Approx dimensions: H 85 cm Ã— W 60 cm Ã— D 55â€“70 cm (model dependent).', gu: 'àª®àª¾àªª: H 85 cm Ã— W 60 cm Ã— D 55â€“70 cm (àª®à«‹àª¡à«‡àª² àªªàª° àª†àª§àª¾àª°).' },
    { q: /electric|power|watt|energy/i, en: 'Typical energy per full wash ~1.2â€“1.5 kWh; Eco modes reduce consumption.', gu: 'àªªà«‚àª°àª¨à«‡ àªµàª°à«àª·àª¨à«€ àª–à¤ªà¤¤ ~1.2â€“1.5 kWh; àªàª•à«‹ àª®à«‹àª¡ àªŠàª°à«àªœàª¾ àª¬àªšàª¾àªµà«‡ àª›à«‡.' },
    { q: /dryer|dry function/i, en: 'Some variants have dryer function; check specific model.', gu: 'àª•à«‡àªŸàª²àª¾àª• àª®à«‹àª¡à«‡àª²àª®àª¾àª‚ àª¡à«àª°àª¾àª¯àª° àª«àª‚àª•à«àª¶àª¨ àª¹à«‹àª¯ àª›à«‡; àªšà«‹àª•à«àª•àª¸ àª®à«‹àª¡à«‡àª² àª¤àªªàª¾àª¸à«‹.' },
    { q: /inverter|digital inverter|motor/i, en: 'Yes â€” uses a Digital Inverter Motor for durability and efficiency.', gu: 'àª¹àª¾ â€” àª¡àª¿àªœàª¿àªŸàª² àª‡àª¨àªµàª°à«àª¤àª° àª®à«‹àªŸàª° àª¸àª¾àª¥à«‡ àª†àªµà«‡ àª›à«‡.' },
    { q: /advantages|why should i buy|benefit/i, en: 'Advantages: large capacity, efficient motor, advanced wash programs and optional smart features.', gu: 'àª²àª¾àª­: àª®à«‹àªŸà«€ àª•à«àª·àª®àª¤àª¾, àª•àª¾àª°à«àª¯àª•à«àª·àª® àª®à«‹àªŸàª°, àª…àª¦à«àª¯àª¤àª¨ àªªà«àª°à«‹àª—à«àª°àª¾àª® àª…àª¨à«‡ SMART àª«à«€àªšàª°à«àª¸.' },
    { q: /programs|quick wash|eco wash|special programs/i, en: 'Includes Quick Wash, Eco, Hygiene/Steam cycles on many variants.', gu: 'àª•à«àªµàª¿àª• àªµà«‹àª¶, àªàª•à«‹, àª¸à«àªŸà«€àª®/àª¹àª¾àª‡àªœà«€àª¨ àªªà«àª°à«‹àª—à«àª°àª¾àª® àª‰àªªàª²àª¬à«àª§ àª›à«‡.' },
    { q: /heavy loads|blankets|curtains/i, en: 'Yes â€” 12kg handles blankets and bulky items comfortably.', gu: 'àª¹àª¾ â€” 12 kg àª­àª¾àª°à«‡ àª²à«‹àª¡ àª¸àª°àª³à«‡ àª¹à«‡àª¨à«àª¡àª² àª•àª°à«‡ àª›à«‡.' },
    { q: /feedback|reviews|customer review/i, en: 'Sample feedback: 1) Great cleaning. 2) Large drum â€” ideal for bedding. 3) Smart features useful. 4) Quiet operation.', gu: 'àª—à«àª°àª¾àª¹àª• àªªà«àª°àª¤àª¿àª¸àª¾àª¦: 1) àª¸àª¾àª°à«€ àª¸àª«àª¾àªˆ. 2) àª®à«‹àªŸà«€ àª¡à«àª°àª®. 3) àª¸à«àª®àª¾àª°à«àªŸ àª«à«€àªšàª°à«àª¸. 4) àª¶àª¾àª‚àª¤.' }
  ];
  const GLOBAL_PROMPTS = [
    { q: /service|repair|support/i, en: 'We provide doorstep service and free checkups during warranty period. Contact store.', gu: 'àªµà«‹àª°àª‚àªŸà«€ àª¦àª°àª®àª¿àª¯àª¾àª¨ àª¡à«‹àª°àª¸à«àªŸà«‡àªª àª¸àª°à«àªµàª¿àª¸ àª‰àªªàª²àª¬à«àª§ àª›à«‡. àª¸à«àªŸà«‹àª° àª¸àª‚àªªàª°à«àª• àª•àª°à«‹.' }
  ];
  function findAnswer(text){
    const q = text.toLowerCase();
    for(const p of PRODUCT_PROMPTS) if(p.q.test(q)) return (currentLang==='en' ? p.en : p.gu);
    for(const g of GLOBAL_PROMPTS) if(g.q.test(q)) return (currentLang==='en' ? g.en : g.gu);
    if(/describe|description|details|model description|all description/i.test(q)) return currentLang==='en' ? PRODUCT.description_en : PRODUCT.description_gu;
    return null;
  }

  /* ------------- speech (synthesis + tap) ------------- */
  function speak(text){ if(!('speechSynthesis' in window)) return; const u=new SpeechSynthesisUtterance(text); u.lang = (currentLang==='en' ? 'en-IN' : 'gu-IN'); window.speechSynthesis.cancel(); window.speechSynthesis.speak(u); }
  let audioCtx=null;
  function playTap(){ try{ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); const now=audioCtx.currentTime; const o=audioCtx.createOscillator(); const g=audioCtx.createGain(); o.type='sine'; o.frequency.setValueAtTime(1100,now); g.gain.setValueAtTime(0,now); g.gain.linearRampToValueAtTime(0.12, now+0.002); g.gain.exponentialRampToValueAtTime(0.001, now+0.12); o.connect(g); g.connect(audioCtx.destination); o.start(now); o.stop(now+0.14);}catch(e){} }

  /* ------------- recognition ------------- */
  let recognition=null; let lastHeard=false;
  if(window.SpeechRecognition || window.webkitSpeechRecognition){
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    recognition = new SR(); recognition.lang='en-IN'; recognition.interimResults=false; recognition.maxAlternatives=1;
    recognition.onresult = (e)=>{ lastHeard=true; const txt=e.results[0][0].transcript; addMessage(txt,'user'); processQuery(txt); };
    recognition.onend = ()=>{ document.getElementById('mainMic').classList.remove('listening'); if(!lastHeard) document.getElementById('transcript').textContent = (currentLang==='en' ? 'Tap mic to speak' : 'àª®àª¾àª‡àª• àª¦àª¬àª¾àªµà«‹ àª…àª¨à«‡ àª¬à«‹àª²à«‹'); lastHeard=false; };
    recognition.onerror = (e)=>{ document.getElementById('transcript').textContent = 'Error: ' + (e.error || e.message); document.getElementById('mainMic').classList.remove('listening'); lastHeard=false; };
  }

  /* ------------- chat UI ------------- */
  const messages = document.getElementById('messages');
  function addMessage(text, who='user'){ const b=document.createElement('div'); b.className='bubble ' + (who==='user' ? 'user' : 'bot'); b.textContent=text; messages.appendChild(b); messages.scrollTop = messages.scrollHeight; }
  function respond(text){ if(!text) text = (currentLang==='en' ? "Sorry, I don't have that info. Ask about price, usage, warranty or features." : "àª®àª¾àª« àª•àª°àª¶à«‹, àª®àª¾àª°à«€ àªªàª¾àª¸à«‡ àª¤à«‡ àª®àª¾àª¹àª¿àª¤à«€ àª¨àª¥à«€."); document.getElementById('transcript').textContent = (currentLang==='en' ? 'Assistant: ' : 'àª¸àª¹àª¾àª¯àª•: ') + text; addMessage(text,'bot'); speak(text); }
  function processQuery(text){ const ans = findAnswer(text); if(ans) { respond(ans); return; } respond(null); }

  /* ------------- main mic handlers ------------- */
  const mainMic = document.getElementById('mainMic');
  mainMic.addEventListener('click', ()=> {
    playTap();
    if(!recognition){
      const q = prompt(currentLang==='en' ? 'Type your question:' : 'àª¤àª®àª¾àª°à«‹ àªªà«àª°àª¶à«àª¨ àª²àª–à«‹:');
      if(q){ addMessage(q,'user'); processQuery(q); } return;
    }
    mainMic.classList.add('listening');
    document.getElementById('transcript').textContent = (currentLang==='en' ? 'Listening...' : 'àª¶à«àª£àªµàª¾àª®àª¾àª‚ àª†àªµà«€ àª°àª¹à«àª¯à«àª‚ àª›à«‡...');
    lastHeard=false; recognition.lang = (currentLang==='en' ? 'en-IN' : 'gu-IN'); try{ recognition.start(); }catch(e){ mainMic.classList.remove('listening'); }
  });
  // keyboard activation
  mainMic.addEventListener('keydown', e => { if(e.key==='Enter' || e.key===' ') e.target.click(); });

  // chat send & mic
  const chatInput = document.getElementById('chatInput'), sendBtn = document.getElementById('sendBtn'), chatMicEl = document.getElementById('chatMic');
  sendBtn.addEventListener('click', ()=> { const v = chatInput.value.trim(); if(!v) return; addMessage(v,'user'); chatInput.value=''; processQuery(v); });
  chatInput.addEventListener('keydown', e => { if(e.key==='Enter'){ e.preventDefault(); sendBtn.click(); }});
  chatMicEl.addEventListener('click', ()=> {
    playTap();
    if(!recognition){
      const q = prompt(currentLang==='en' ? 'Type your question:' : 'àª¤àª®àª¾àª°à«‹ àªªà«àª°àª¶à«àª¨ àª²àª–à«‹:');
      if(q){ addMessage(q,'user'); processQuery(q); } return;
    }
    mainMic.classList.add('listening');
    document.getElementById('transcript').textContent = (currentLang==='en' ? 'Listening...' : 'àª¶à«àª£àªµàª¾àª®àª¾àª‚ àª†àªµà«€ àª°àª¹à«àª¯à«àª‚ àª›à«‡...');
    lastHeard=false; recognition.lang = (currentLang==='en' ? 'en-IN' : 'gu-IN'); try{ recognition.start(); }catch(e){ mainMic.classList.remove('listening'); }
  });

  // init language default
  setLang('en');
  document.getElementById('transcript').textContent = 'Assistant ready. Select language and tap mic or type your question.';

});
</script>
</body>
</html>
